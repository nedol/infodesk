{"version":3,"sources":["webpack:///./browser/browser.js"],"names":[],"mappings":";;;;;;AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;;AAEA,CAAC;;AAED;AACA;AACA;AACA,CAAC;;AAED;;AAEA,+BAA+B;;AAE/B;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,KAAK;AACL;AACA;AACA;;;;AAIA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;;AAEA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,KAAK;;AAEL;AACA;;;AAGA;AACA;AACA;AACA,uCAAuC,SAAS;AAChD;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA,uBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,UAAU;AACV;;AAEA,KAAK;AACL;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,oCAAoC;AACpC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qBAAqB;AACrB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA,KAAK;AACL;AACA;AACA;;;AAGA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,SAAS;;AAET;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;;AAErB;AACA;AACA,wCAAwC;;AAExC,sBAAsB,EAAE;;AAExB;AACA;AACA;;AAEA;AACA,2EAA2E;AAC3E;AACA;AACA;AACA,qBAAqB;;;AAGrB;AACA;AACA,qBAAqB;;AAErB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA,6BAA6B,EAAE;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA,oCAAoC;AACpC,yBAAyB;AACzB;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA,2DAA2D,0BAA0B;AACrF;AACA;;AAEA;AACA;AACA;;AAEA;AACA,yDAAyD;AACzD;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,qDAAqD;AACrD;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iGAAiG;AACjG;AACA,yBAAyB;AACzB;AACA;AACA,qGAAqG;AACrG;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,qBAAqB;AACrB;;AAEA;AACA;AACA,aAAa;AACb;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,aAAa;;AAEb;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;;;AAGT;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;;AAEA,wCAAwC;;AAExC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB;AACA;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA,SAAS;;AAET;;AAEA;AACA;AACA;;AAEA;;AAEA,qDAAqD;;AAErD;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;;AAEA,SAAS;;AAET,qCAAqC;;AAErC;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,wBAAwB;AACxB;;AAEA;;AAEA,iBAAiB;;AAEjB;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,aAAa;;AAEb;AACA;AACA;;AAEA;AACA,SAAS;;AAET,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA,wCAAwC;AACxC;AACA,kCAAkC;;AAElC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iDAAiD;;AAEjD;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,SAAS;AACT;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET,+EAA+E;;AAE/E;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;;AAEA;;AAEA,aAAa;;AAEb,SAAS;;AAET;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,wCAAwC,gBAAgB;AACxG;AACA;AACA,sEAAsE;AACtE;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC,uFAAuF;AACvF;AACA;AACA,uDAAuD,oCAAoC,gBAAgB;AAC3G;AACA;AACA,mEAAmE;AACnE;AACA;;AAEA,6BAA6B;AAC7B;AACA;;AAEA;AACA,6BAA6B;AAC7B;AACA;AACA,+CAA+C,wCAAwC,2BAA2B;AAClH;AACA;AACA,6BAA6B;AAC7B,yBAAyB;AACzB,qBAAqB;;AAErB;AACA;AACA,uDAAuD;AACvD;AACA;AACA,iBAAiB;;AAEjB,aAAa;;AAEb,SAAS;;AAET;AACA;AACA;AACA;;AAEA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA,SAAS;;AAET;AACA,SAAS;;AAET;;AAEA,SAAS;;AAET;AACA;AACA;;AAEA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA,UAAU,EAAE;;AAEZ,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,wCAAwC,SAAS;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,KAAK;AACL,C","file":"browser.js","sourcesContent":["// import\r\n\r\nvar IsAnimate = true;\r\nvar interupt, processResult;\r\nvar cur_div;\r\nvar dnld_timeout, final_timeout;\r\nvar screenY;\r\nvar up_down;\r\nvar isStopPlaying;\r\nvar lang = 'en';\r\n\r\nvar mObjectAr = jQuery.makeArray();\r\nvar mAudioAr = jQuery.makeArray();\r\n\r\nif (localStorage.getItem(\"lang\")) {\r\n    lang = localStorage.getItem(\"lang\");\r\n}\r\n\r\ndocument.onreadystatechange = function(){\r\n    if(document.readyState === 'complete'){\r\n        //LoadPage_0('test');\r\n    }\r\n}\r\n\r\nwindow.addEventListener('error', function(e) {\r\n    var ie = window.event || {};\r\n    var errMsg = e.message || ie.errorMessage || \"404 error on \" + window.location;\r\n    var errSrc = (e.id || ie.errorUrl) + ': ' + (e.lineno || ie.errorLine);\r\n    //alert(errMsg+errSrc);\r\n}, true);\r\n\r\n$( document ).ready( function(){\r\n\r\n});\r\n\r\n$( document ).ajaxError(function(jqXHR,  textStatus, errorThrown) {\r\n    console.log(JSON.stringify(jqXHR));\r\n    console.log(\"AJAX error: \" + textStatus + ' : ' + errorThrown);\r\n});\r\n\r\nfunction ShowAlert(str){\r\n\r\n    $(\"#span_alert\").text(str);//.delay(3000);\r\n\r\n}\r\n\r\nfunction SoftInput(obj){\r\n\r\n    try{\r\n\r\n        $(':focus').val(obj.msg);\r\n\r\n        //Alert($(':focus').toString());\r\n\r\n    }catch(e){\r\n        //Alert(e.toString());\r\n    }\r\n}\r\n\r\n\r\n\r\nfunction CleanContent(){\r\n    //jQuery('html,body').empty();\r\n    location.reload();\r\n}\r\n\r\n\r\nfunction scrollToTop(element, callback){\r\n\r\n    if(IsAnimate && element instanceof Object){\r\n        ////ShowAlert(IsAnimate);\r\n        $('html, body').stop().animate({\r\n            scrollTop: $(element).offset().top\r\n            ////scrollTop: $('#your-id').offset().top\r\n            ////scrollTop: $('.your-class').offset().top\r\n        }, 1300, 'swing', function() {\r\n            //console.log(\"Finished animating\"+$(element).offset().top);\r\n            callback();\r\n        });\r\n    }\r\n}\r\n\r\nfunction scrollToBottom(element, callback){\r\n\r\n    if(IsAnimate && element instanceof Object){\r\n        $('html, body').stop().animate({\r\n            scrollTop: $(element).offset().top - window.innerHeight + $(element).height()+25\r\n        }, 1300,'swing',function(){\r\n            callback();\r\n        });\r\n    }\r\n}\r\n\r\nfunction LoadingResource(obj){\r\n    try{\r\n        if(interupt!==\"undefined\")\r\n            $(\"[isLoaded='false']\").each(function(){\r\n                clearTimeout($(this).attr('dnld_timeout'));\r\n                $(this).attr('dnld_timeout',setTimeout(interupt.func, 7000));\r\n                //ShowAlert(($(this).attr('dnld_timeout')));\r\n            });\r\n    }catch(ex){\r\n\r\n    }\r\n}\r\n\r\n\r\nwindow.StopPlaying = function(){\r\n    isStopPlaying = true;\r\n    var audios = document.getElementsByTagName('audio');\r\n    for(var i = 0, len = audios.length; i < len;i++){\r\n        if(audios[i].getAttribute('id')!==\"audio_0\")\r\n            if(audios[i].paused == false ){\r\n                audios[i].pause();\r\n            }\r\n    }\r\n}\r\n\r\nfunction LoadPage_0 (caption){\r\n\r\n    var obj =\r\n        {\r\n            'func':'InsertIFrame',\r\n            'url':'http://nedol.ru',\r\n            'id':'start_page',\r\n            'caption':caption\r\n        };\r\n\r\n    var sAr= [];\r\n    sAr.push(obj);\r\n\r\n    InsertElements(sAr);\r\n}\r\n\r\n\r\nwindow.InsertElements = function(sAr){\r\n    IsAnimate = true;\r\n    try{\r\n        //$(\"span\").text(\"mAr.length:\"+mAr.length);\r\n\r\n        for (var i = 0; i < sAr.length;i++){\r\n            if(sAr[i].type==='1')\r\n                mAudioAr.push(sAr[i]);\r\n            else\r\n                mObjectAr.push(sAr[i]);\r\n\r\n        }\r\n\r\n        Dispatch();\r\n\r\n        /*\r\n         $.each( mImageAr, function( key, value ) {\r\n         alert( key + \": \" + value );\r\n         });\r\n         */\r\n\r\n    }catch(ex){\r\n        console.log(ex);\r\n    }\r\n\r\n}\r\n\r\nfunction Dispatch() {\r\n\r\n    if (mObjectAr.length > 0) {\r\n\r\n        switch (mObjectAr[0].func) {\r\n            case 'InsertIFrame':\r\n                InsertIFrame(mObjectAr[0]);\r\n                break;\r\n            case 'InsertImage':\r\n                InsertImage(mObjectAr[0]);\r\n                break;\r\n        }\r\n    }\r\n\r\n    if (mAudioAr.length > 0) {\r\n        InsertAudio(mAudioAr[0]);\r\n    }\r\n}\r\n\r\n\r\nvar touchstart_func =  function(event){\r\n    //$(\"span\").text(\" Y: \" + event.originalEvent.touches[0].screenY);\r\n    up_down = false;\r\n    screenY = event.originalEvent.touches[0].screenY;\r\n};\r\n\r\nvar touchmove_func =  function(event){\r\n\r\n    if(up_down)\r\n        return;\r\n\r\n    if(screenY > event.originalEvent.touches[0].screenY){\r\n        //$(\"span\").text(\"tap up: screenY:\"+screenY+\" eventY:\"+event.originalEvent.touches[0].screenY);\r\n        up_down = \"up\";\r\n    }else{\r\n        up_down = \"down\";\r\n        //$(\"span\").text(\"tap down: screenY:\"+screenY+\" eventY:\"+event.originalEvent.touches[0].screenY);\r\n\r\n// Alert($(\"body\").html());\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n    }\r\n    //$(newDiv).unbind('touchmove');\r\n\r\n};\r\n\r\nvar touchend_func =  function(event){\r\n    if(up_down===\"down\") {\r\n\r\n        cur_div = $(cur_div).prev();// $(newDiv.prev());\r\n        //$(\"span\").text(\"down:\"+$(cur_div).attr(\"id\")+\" \"+($(cur_div).attr(\"id\")===\"img_container\").toString());\r\n\r\n        try {\r\n            while (!jQuery.isEmptyObject($(cur_div))) {\r\n                if ($(cur_div).find(\".iframe\").attr(\"isLoaded\") == \"true\" ||\r\n                    $(cur_div).find('.div_img').length>0 ||\r\n                    $(cur_div).find('.div_audio').length>0\r\n                ) {\r\n                    $(cur_div).bind('touchmove', touchmove_func);\r\n                    IsAnimate = true;\r\n                    scrollToTop(cur_div, function () {\r\n\r\n                    });\r\n                    break;\r\n                } else {\r\n                    cur_div = $(cur_div).prev();\r\n                    //$(\"span\").text(\"prev:\" + $(cur_div).attr(\"class\").toString());\r\n                    if ($(cur_div).attr(\"class\") === null)\r\n                        break;\r\n                    if ($(cur_div).attr(\"id\").toString() === \"img_container\")\r\n                        break;\r\n                }\r\n            }\r\n        } catch (ex) {\r\n\r\n        }\r\n    }else if(up_down==='up'){\r\n        //$(\"span\").text(\"up:\"+$(cur_div).attr(\"id\")+\" \"+($(cur_div).attr(\"id\")===\"img_container\").toString());\r\n    }\r\n};\r\n\r\n\r\nfunction InsertIFrame(obj_0){\r\n\r\n    var newFrame ;\r\n\r\n    try{\r\n\r\n        $(\".div_iframe\").each( function( index, element) {\r\n            //alert( \"id:\"+ $( element).attr( \"id\"));\r\n            if($( element).attr( \"id\")===obj_0.id+\"_container\")\r\n                $( element).remove();\r\n        });\r\n\r\n        var obj =  mObjectAr.shift();\r\n\r\n        var if_0 = $('#iframe_container');\r\n        var newDiv = $(if_0).clone();\r\n        $(newDiv).attr( \"id\",obj_0.id+\"_div\");\r\n\r\n        newFrame = $(newDiv).find(\".timeline\").eq(0);\r\n        $(newFrame).attr( \"id\",obj_0.id+\"_iframe\");\r\n///////////////////////////////////////////////////////////////////////////////////////////////////////////\r\n        interupt = {\r\n            func: function InteruptLoad() {\r\n                if($(newFrame).width() != $(window).width() || $(newFrame).height != $(window).height()){\r\n                    //$(\"span\").text(\"1:\"+dnld_timeout);\r\n                    if( $(newFrame).attr('isLoaded')===false){\r\n                        ////ShowAlert(\"2:\"+$(newFrame).attr('isLoaded'));\r\n                        $(newFrame).remove();\r\n                    }\r\n\r\n                    $(newDiv).find(\".progress\").attr('src',\"./images/ic_no_preview.png\");\r\n                    clearTimeout(dnld_timeout);\r\n                    clearTimeout(final_timeout);\r\n\r\n                    if(typeof mObjectAr[0]!=='undefined') {\r\n                        ////ShowAlert(\"length\"+mIFrameAr.length+\" mImageAr:\"+mIFrameAr[0]);\r\n                        InsertIFrame(mObjectAr[0]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        processResult  = {\r\n            func: function processResult(data, textStatus, jqXHR) {\r\n\r\n                clearTimeout(dnld_timeout);\r\n\r\n                var content_len = 1;\r\n                try {\r\n                    if($($(this)[0]).contents())\r\n                        content_len = $($(this)[0]).find('body>*').length;\r\n                } catch (e) {\r\n                    console.log(\"download error:\"+e);\r\n                }\r\n\r\n                if (content_len <= 0) {\r\n\r\n                    $(newDiv).find(\".progress\").attr('src', \"./images/ic_no_preview.png\");\r\n                    $(newDiv).find('.div_iframe').eq(0).fadeOut(100);\r\n                    $(newFrame).attr('isLoaded', false);\r\n                    $(newImg).css('display', 'inline-block');\r\n                    //alert(\"download error:\"+e);\r\n                    //HtmlViewer.IFrameLoad(\"\");\r\n\r\n                } else {\r\n                    $(newFrame).height(window.innerHeight - 50);\r\n                    $(newFrame).width(window.innerWidth - 20);\r\n                    //alert(\"load:\"+$(newFrame).attr('isLoaded'));\r\n                    $(newDiv).find(\".progress\").remove();\r\n                    $(newDiv).css('padding-bottom', '20px');\r\n                    $(newDiv).find(\".div_iframe\").eq(0).css('display', 'block');\r\n                    $(newDiv).find(\".favourites\").eq(0).attr('id', obj_0.id+\"_favourites\");\r\n                    $(newDiv).find(\"#prev\").on('click', function () {\r\n                        window.history.back();\r\n                    });\r\n\r\n                    /*\r\n                     $(newDiv).find(\"#scroll_div_right\").on('tapmove', function(e){\r\n                     //alert('tapmove'); work!\r\n\r\n                     });*/\r\n\r\n                    //$(newDiv).bind('touchstart',touchstart_func);\r\n                    //$(newDiv).bind('touchmove',touchmove_func);\r\n                    //$(newDiv).bind('touchend',touchend_func);\r\n\r\n                    $(document).on('scroll', function (e) {\r\n                        //$(\"span\").text('scroll:'+$(newDiv).offset().top); //works\r\n                        e.preventDefault();\r\n                        e.stopPropagation();\r\n                        //return false;\r\n                    });\r\n\r\n\r\n                    $('a[target=\"_blank\"]').each(function () {\r\n                        $(this).remove();\r\n                    });\r\n\r\n                    if ($(newFrame).attr('isLoaded') === 'false') {\r\n                        IsAnimate = true;\r\n                        scrollToTop($(newDiv).find(\".title_div\"), function () {\r\n\r\n                            /*\r\n                            var canvas = document.querySelector(\"canvas\");\r\n                            html2canvas(newFrame,\r\n                                {\r\n                                    canvas: canvas,\r\n                                    logging: true, //Enable log (use Web Console for get Errors and Warnings)\r\n                                    proxy:\"../../php/utils/html2canvasproxy.php\"\r\n                                }).then(function(canvas) {\r\n                                console.log('Drew on the existing canvas');\r\n                                var img = new Image();\r\n                                img.onload = function() {\r\n                                    this.onload = null;\r\n                                    //TODO document.body.appendChild(this);\r\n                                };\r\n                                img.onerror = function() {\r\n                                    img.onerror = null;\r\n                                    if(window.console.log) {\r\n                                        window.console.log(\"Not loaded image from canvas.toDataURL\");\r\n                                    } else {\r\n                                        alert(\"Not loaded image from canvas.toDataURL\");\r\n                                    }\r\n                                };\r\n                                var data = canvas.toDataURL(\"image/png\");\r\n                                img.src = data;\r\n                            });*/\r\n                            // var node = document.getElementsByClassName('timeline')[0];\r\n                            // domtoimage.toPng(node)\r\n                            //     .then(function (dataUrl) {\r\n                            //         var img = new Image();\r\n                            //         img.src = dataUrl;\r\n                            //         document.body.appendChild(img);\r\n                            //     })\r\n                            //     .catch(function (error) {\r\n                            //         console.error('oops, something went wrong!', error);\r\n                            //     });\r\n                        });\r\n                    }\r\n\r\n                    $(newFrame).attr('isLoaded', true);\r\n\r\n                }\r\n\r\n                //ShowAlert(\" mIFrameAr:\"+mIFrameAr[0]);\r\n                if (typeof mObjectAr[0] !== 'undefined') {\r\n                    ////ShowAlert(\"length\"+mIFrameAr.length+\" mImageAr:\"+mIFrameAr[0]);\r\n                    InsertIFrame(mObjectAr[0]);\r\n                }\r\n            }\r\n        }\r\n\r\n        clearTimeout(dnld_timeout);\r\n        dnld_timeout = setTimeout(interupt.func, 5000);\r\n        $(newFrame).attr('dnld_timeout',dnld_timeout);\r\n        final_timeout = setTimeout(interupt.func, 10000);\r\n\r\n        if(obj.id){\r\n\r\n            var title_text = $(newDiv).find(\".title\")[0];\r\n            $(title_text).html(obj.caption);\r\n\r\n            $(newDiv).css('display',\"block\");\r\n            $(newDiv).attr('id', obj.id+\"_container\");\r\n            $(newDiv).attr('class', \"container\");\r\n\r\n\r\n            //newFrame.style=\"-webkit-transform:scale(1.0);-moz-transform-scale(0.5);\" ;\r\n            $(newFrame).css( '-webkit-transform','scale(1.0)');\r\n            $(newFrame).attr('id', obj.id);\r\n\r\n            $(newFrame).attr('frameBorder',\"0\");\r\n            //$(newDiv).find('.progress').eq(0).attr('id','progress_active');\r\n            $(newFrame).attr('isLoaded',false);\r\n\r\n            $('#bottom').before($(newDiv));\r\n            $(newDiv).after('<div style=\\\"display: block; height: 10px\\\"></div>');\r\n            cur_div = $(newDiv);\r\n            //  Title\r\n\r\n            try {\r\n\r\n                if((obj.url.includes(\"https://\") || obj.url.includes(\"../\"))\r\n                    && obj.status!=='3'\r\n                    && !obj.url.includes(\"facebook.\")\r\n                    && !obj.url.includes(\"vk.com\")) {\r\n                    $(newFrame).attr('src', obj.url);//http==='https://'? obj.url.replace(\"http://\",\"https://\"):obj.url);\r\n                    $(newFrame).on('load', processResult.func);\r\n                }else {\r\n                    $.ajax({\r\n                        url: obj.url.replace(\"http:\", location.protocol),\r\n                        method: \"GET\",\r\n                        dataType: 'jsonp',\r\n                        crossDomain: true,\r\n                        timeout: 5000,\r\n                        // headers: request_headers,\r\n                        success: function () {\r\n                            $(newFrame).attr('src', obj.url.replace(\"http:\", location.protocol));//http==='https://'? obj.url.replace(\"http://\",\"https://\"):obj.url);\r\n                            $(newFrame).on('load', processResult.func);\r\n                        },\r\n                        error: function (parsedjson) {\r\n                            if (parsedjson.status == \"200\") {\r\n                                $(newFrame).attr('src', obj.url.replace(\"http:\", location.protocol));//http==='https://'? obj.url.replace(\"http://\",\"https://\"):obj.url);\r\n                                $(newFrame).on('load', processResult.func);\r\n                            } else {\r\n                                // Handle error\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n\r\n                //var win = window.frames.target;\r\n                //$(newFrame).eq(0).html('<object id=\"browser\" type=\"text/html\" data='+obj.url+'  width=\"100%\" height=\"100%\" ></object>');\r\n            }catch (ex){\r\n                console.log(ex);\r\n            }\r\n\r\n            scrollToBottom(title_text, function(){\r\n\r\n                while($('.container').size()>30){\r\n                    $( \"body\" ).find('.container').eq(0).remove();\r\n                }\r\n\r\n                while($('[isLoaded=true]').size()>5){\r\n\r\n                    $( \"body\" ).find( \"[isLoaded=true]\").eq(0).parent().find(\"#scroll_div_right\").remove();\r\n                    $( \"body\" ).find( \"[isLoaded=true]\").eq(0).parent().find(\"#scroll_div_left\").remove();\r\n                    $( \"body\" ).find( \"[isLoaded=true]\").eq(0).remove();\r\n                }\r\n            });\r\n\r\n        }\r\n\r\n        ////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n        var imgOwner = $(newDiv).find(\".owner_logo\").eq(0);\r\n        if(obj.owner === \"google places\"){\r\n            //alert(\"owner:\"+obj.owner);\r\n            $(imgOwner).attr('src', \"./images/google.png\");\r\n\r\n        }else if(obj.owner === 'osm'){\r\n            //alert(\"owner:\"+obj.owner);\r\n            $(imgOwner).attr('src', \"./images/osm_logo.png\");\r\n        }else if(obj.owner === 'wikipedia'){\r\n            //alert(\"owner:\"+obj.owner);\r\n            $(imgOwner).attr('src', \"./images/wiki_logo.png\");\r\n        }\r\n\r\n        $(imgOwner).css(\"visibility\",\"visible\");\r\n\r\n        var newImg = $(newDiv).find(\".favourites\").eq(0);\r\n\r\n        $(newImg).click( function() {\r\n            ////ShowAlert('click favourites');\r\n            //HtmlViewer.DeployAudio(audio.userId,audio.fileId,audio.url,audio.hash);\r\n            $(newImg).attr('src','../images/ic_heart_red.png');\r\n            window.parent.AddToFavourites(obj.id);\r\n        });\r\n\r\n\r\n        ////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n        var onscroll_event = false;\r\n\r\n        ////////////////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n        if(typeof $(newFrame).attr('src')===\"undefined\" || $(newFrame).attr('src')===\"\"){\r\n\r\n            if(typeof mObjectAr[0]!=='undefined') {\r\n                ////ShowAlert(\"length\"+mIFrameAr.length+\" mImageAr:\"+mIFrameAr[0]);\r\n                InsertIFrame(mObjectAr[0]);\r\n            }\r\n            return;\r\n        }\r\n\r\n    }catch(ex){\r\n        $(newFrame).remove();\r\n        if(typeof mObjectAr[0]!=='undefined') {\r\n            //ShowAlert(\"Ex:\"+ex);\r\n            //InsertIFrame(mIFrameAr[0]);\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\nfunction InsertImage(img_0){\r\n    try{\r\n\r\n        var img = jQuery.extend(true, {}, img_0);\r\n\r\n        mObjectAr.shift();\r\n\r\n        ////ShowAlert(obj.hash);\r\n        var if_0 = $('#img_container');\r\n        var newDiv = $(if_0).clone();\r\n        $(newDiv).css('display',\"block\");\r\n        $(newDiv).attr('id', img.id+\"_container\");\r\n        $(newDiv).attr('class', \"container\");\r\n        $(newDiv).find('.progress').attr('id','progress_active');\r\n\r\n        var newImg = $(newDiv).find('#img_0');\r\n        ////ShowAlert(obj.url);\r\n\r\n        window.parent.db.getFile(MD5(img.id), function (res) {\r\n            if(res!==-1) {\r\n                $(newImg).attr('src', res.data);\r\n            }else{\r\n                $.ajax({\r\n                    url: http+host+\"/php/get_file.php?url=\"+img.url+\"hash=\"+img.id+\"&table=photos&XDEBUG_SESSION_START=PHPSTORM\",\r\n                    type: \"GET\",\r\n                    processData:false,\r\n                    async: true,   // asynchronous request? (synchronous requests are discouraged...)\r\n                    cache: false,   // with this, you can force the browser to not make cache of the retrieved data\r\n                    dataType: \"text\",\r\n                    success: function (data) {\r\n                        var img = JSON.parse(data);\r\n                        $(newImg).attr('src', img.content);\r\n                    },//,dataType: \"json\"\r\n                    error: function(){\r\n                        console.log();\r\n                    },\r\n                    complete: function (data) {\r\n                        //alert(data.responseText);\r\n                    },\r\n                });\r\n            }\r\n        });\r\n\r\n        //$(newImg).attr('src', img.url);\r\n\r\n        $(newImg).attr('id',img.id);\r\n        $(newImg).attr('width', '100%');\r\n        $(newImg).attr('height', '100%');\r\n\r\n        $('#bottom').before($(newDiv));\r\n\r\n        $(newDiv).after('<div style=\\\"display: block; height: 10px\\\"></div>');\r\n\r\n        cur_div = $(newDiv);\r\n\r\n        if(!$.fn.isEmpty(img.id)){\r\n\r\n            var title_text = $(newDiv).find(\".title\")[0];\r\n            $(title_text).html(img.caption);\r\n            $(title_text).on('input', function () {\r\n                var obj = JSON.parse(localStorage.getItem(img.id));\r\n                obj.caption = $(this).text();\r\n                localStorage.setItem(img.id,JSON.stringify(obj));\r\n            });\r\n\r\n            var poiImg = $(newDiv).find(\".favourites\");\r\n            if(img.class != 'msg_assist' && img.class!='photo'){\r\n                $(poiImg).attr('id', img.id);\r\n            }else{\r\n                $(poiImg).hide();\r\n            }\r\n\r\n            //scrollToBottom(title_text);\r\n        }\r\n\r\n        var dnld_timeout = setTimeout( function() {\r\n\r\n            if($(newImg).width() != $(window).width() || $(newImg).height != $(window).height()){\r\n\r\n                $(newImg).remove();\r\n                $(newDiv).find(\"#progress_active\").remove();\r\n            }\r\n\r\n            if(mObjectAr[0]) {\r\n                Dispatch();\r\n            }else{\r\n                clearTimeout(dnld_timeout);\r\n            }\r\n\r\n        }, 10000);\r\n\r\n        //clearTimeout(dnld_timeout);//DEBUG\r\n\r\n        $(newDiv).find(\".favourites\").eq(0).attr('id',img.id);\r\n\r\n        $(newImg).on('load',function() {\r\n\r\n            clearTimeout(dnld_timeout);\r\n\r\n            $(newDiv).find(\"#progress_active\").remove();\r\n\r\n            var img = new Image();\r\n            img.src = $(newImg).attr('src');\r\n            img.onload = function () {\r\n                var w = this.width;\r\n                var h = this.height;\r\n                $(newImg).width($(newImg).parent().width());\r\n\r\n                //$(newImg).removeAttr('width');\r\n                $(newImg).height(h*($(newImg).width()/w));\r\n\r\n                // newImg = loadImage.scale(\r\n                //     img, // img or canvas element\r\n                //     {maxWidth: $(newImg).parent().width()}\r\n                // );\r\n\r\n                scrollToTop($(newImg), function () {\r\n\r\n                });\r\n\r\n                if(mObjectAr[0]) {\r\n                    Dispatch();\r\n                }\r\n\r\n            }\r\n\r\n            $(newDiv).css('padding-bottom','20px');\r\n\r\n            scrollToTop(newDiv, function () {\r\n\r\n            });\r\n\r\n            //$(newDiv).bind('touchstart',touchstart_func);\r\n            //$(newDiv).bind('touchmove',touchmove_func);\r\n            //$(newDiv).bind('touchend',touchend_func);\r\n\r\n            //HtmlViewer.IFrameLoad(this.id);\r\n        });\r\n\r\n    }catch(e){\r\n        //ShowAlert(e.toString());\r\n    }\r\n    //  Title\r\n\r\n}\r\n\r\nfunction InsertAudio(audio){\r\n    //var audio = jQuery.extend(true, {}, audio);\r\n    var audio = mAudioAr.shift();\r\n    audio = jQuery.extend(true, {}, audio);\r\n\r\n    var audio_div = document.getElementById('audio_container');\r\n    var newDiv = audio_div.cloneNode(true);\r\n\r\n    $(audio_div).attr('id','div_'+audio.id);\r\n    //$(audio_div).attr('class', audio.class);\r\n    $(newDiv).find(\".favourites\").eq(0).attr('id',audio.id);\r\n\r\n    $(newDiv).css('display','block');\r\n    $('#bottom').before($(newDiv));\r\n    $(newDiv).after('<div style=\\\"display: block; height: 10px\\\"></div>');\r\n\r\n    var donate = $(newDiv).find('.donate');\r\n    if(audio.owner_email){\r\n        $(donate).css(\"display\",\"block\");\r\n        $(donate).attr(\"owner_email\",audio.owner_email);\r\n        $(donate).attr(\"owner\",audio.owner);\r\n    }\r\n\r\n    if(!$.fn.isEmpty(audio.id)){\r\n\r\n        var title_text = $(newDiv).find(\".title\")[0];\r\n        $(title_text).html(audio.caption);\r\n\r\n        scrollToBottom(title_text, function () {\r\n\r\n        });\r\n    }\r\n\r\n    try{\r\n        var player = $(newDiv).find(\"audio\");\r\n\r\n        window.parent.db.getFile(MD5(audio.id), function (res) {\r\n            if(res==-1)\r\n                $(player).attr('src', audio.url);\r\n            else\r\n                $(player).attr('src', res.data);\r\n        })\r\n\r\n        //var canPlayOgg = !!audio.canPlayType && audio.canPlayType('audio/ogg; codecs=\"vorbis\"') != \"\";\r\n\r\n        $(player).attr('class', 'audio_player');\r\n        $(player).attr('id','audio_player_'+audio.id);\r\n        ////ShowAlert(\"IsPlaying():\"+IsPlaying().toString(16));\r\n\r\n        $(player).on('loadeddata', function () {\r\n            if (IsPlaying() === 0) {\r\n                if($(this).attr('id')=== $(player).attr('id'))\r\n                    $(this).trigger('play', true);\r\n                // $(player).prop('autoplay',true);\r\n            }\r\n            if(mAudioAr[0]) {\r\n                ////ShowAlert(\"length\"+mIFrameAr.length+\" mImageAr:\"+mIFrameAr[0]);\r\n                InsertAudio(mAudioAr[0]);\r\n            }\r\n        });\r\n\r\n        $(player).on('play', function () {\r\n            //$(this).delay(1000);\r\n            IsAnimate = true;\r\n            isStopPlaying = false;\r\n\r\n            scrollToTop($(newDiv).find(\".title\"), function () {\r\n                \r\n            });\r\n\r\n        });\r\n\r\n        $(player).on('canplay', function () {\r\n\r\n            $(newDiv).find(\".progress\").remove();\r\n            $(newDiv).bind('touchstart', touchstart_func);\r\n            $(newDiv).bind('touchmove', touchmove_func);\r\n            $(newDiv).bind('touchend', touchend_func);\r\n\r\n            var favourites = $(newDiv).find('.favourites');\r\n            $(favourites).css('visibility', 'visible');\r\n            $(favourites).click(function () {\r\n                $(favourites).attr('src','../images/ic_heart_red.png');\r\n                window.parent.AddToFavourites(audio.id);\r\n                window.parent.db.getFile(MD5(audio.id), function (res) {\r\n                    if(res===-1){\r\n                        // jQuery.get(audio.url,//http+host + \"/php/get_file.php?url=\"+audio.url+ \"&hash=\" + audio.hash + \"&table=records_\" + lang + \"&XDEBUG_SESSION_START=PHPSTORM\",\r\n                        //     function (data) {\r\n                        //         if (data) {\r\n                        //             AddToFavourites(audio.hash);\r\n                        //             setFile({hash: audio.hash, data: \"data:audio/mp3;base64,\" + data});\r\n                        //             var item = JSON.parse(localStorage.getItem(audio.hash));\r\n                        //             item.status = '1';\r\n                        //             var str = JSON.stringify(item);//JSON.stringify()\r\n                        //             localStorage.setItem(audio.hash, str);\r\n                        //         }\r\n                        //     },\r\n                        //     'text');\r\n                        $.ajax({\r\n                            url: http+ host + \"/php/get_file.php?url=\"+audio.url+\"&XDEBUG_SESSION_START=PHPSTORM\",\r\n                            type: \"GET\",\r\n                            processData: false,\r\n                            async: true,   // asynchronous request? (synchronous requests are discouraged...)\r\n                            cache: false,   // with this, you can force the browser to not make cache of the retrieved data\r\n                            dataType: \"text\",\r\n                            headers: {\"Access-Control-Request-Method\": \"GET\",\r\n                                      \"Access-Control-Request-Headers\": \"Content-Type\"},\r\n                            success: function (data) {\r\n                                if(data) {\r\n                                    window.db.setFile({id: audio.id, data: \"data:audio/mp3;base64,\" + data});\r\n                                    var item = JSON.parse(localStorage.getItem(audio.id));\r\n                                    item.status = '1';\r\n                                    var str = JSON.stringify(item);//JSON.stringify()\r\n                                    localStorage.setItem(audio.id, str);\r\n                                }\r\n\r\n                            },//,dataType: \"json\"\r\n                            error: function (xhr, status){\r\n                                if(xhr.responseText) {\r\n\r\n                                }\r\n                            },\r\n                            complete: function (data) {\r\n                                if(data.responseText) {\r\n                                    //setFile({hash: audio.hash, data: \"data:audio/mp3;base64,\"+data.responseText});\r\n                                }\r\n                                console.log();\r\n                            },\r\n                        });\r\n                    }else{\r\n\r\n                        var item = JSON.parse(localStorage.getItem(audio.id));\r\n                        item.status = '1';\r\n                        var str = JSON.stringify(item);//JSON.stringify()\r\n                        localStorage.setItem(audio.id,str);\r\n                    }\r\n                });\r\n\r\n            });\r\n\r\n        });\r\n\r\n        $(player).on('pause', function () {\r\n            //ShowAlert('pause');\r\n            // if(!IsPlaying())\r\n            //     PlayNext($(this));\r\n\r\n        });\r\n\r\n        $(player).on('error', function (error) {\r\n            //ShowAlert(error.code);\r\n            $(newDiv).find(\".progress\").remove();\r\n            //PlayNext($(this));\r\n            //IsPlaying();\r\n        });\r\n\r\n        $(player).on('ended', function () {\r\n            console.log(\"audio onended\");\r\n            PlayNext($(this));\r\n            IsPlaying();\r\n        });\r\n\r\n        $(player).on('abort', function () {\r\n            //$(this).next().trigger('play');\r\n        });\r\n\r\n        $(player).on('suspend', function () {\r\n        });\r\n\r\n        $(player).on('stalled', function () {\r\n\r\n        });\r\n\r\n        $(donate).on('click',  function() {\r\n            ////ShowAlert('click favourites:'+audio.hash);\r\n            //HtmlViewer.DeployAudio(audio.userId,audio.fileId,audio.url,audio.hash);\r\n\r\n            Donate($(this).attr('owner'),$(this).attr('owner_email'));\r\n        });\r\n\r\n        //scrollTo(bottom);\r\n        /*\r\n         $(\"#\"+audio.fileId).ready(function(){\r\n         $(\"#first_div\").fadeOut();\r\n         });*/\r\n\r\n    }catch(e){\r\n        ShowAlert(e.toString());\r\n    }\r\n}\r\n\r\nfunction IsPlaying() {\r\n    var isPlaying = 0;\r\n    var audios = document.getElementsByTagName('audio');\r\n    for (var i = 0, len = audios.length; i < len; i++) {\r\n        if (audios[i].getAttribute('id') !== \"audio_0\")\r\n            if (audios[i].paused == false || audios[i].autoplay) {\r\n                isPlaying++;\r\n            }\r\n    }\r\n    return isPlaying;\r\n}\r\n\r\nfunction PlayNext(el) {\r\n\r\n    var index = $('.audio_player').index($(el));\r\n    var next = $('.audio_player')[index + 1];\r\n    ////ShowAlert($(next).prop(\"tagName\").toString());\r\n    if ($(next).attr(\"class\") === \"audio_player\")\r\n        $(next).trigger('play');\r\n}\r\n\r\nfunction OpenNewWindow(event, str, title){\r\n\r\n    window.open(event, str, \"width=300, height=300\");\r\n    //event.preventDefault();\r\n    scrollToBottom($('#bottom'), function () {\r\n\r\n    });\r\n}\r\n\r\nfunction Donate(owner, email){\r\n    var cur = 'RUB';\r\n    if(lang==\"en\"){\r\n        cur = \"USD\";\r\n    }\r\n    var url =\r\n        //\"http://a07513cy.bget.ru/travelnotes/php/donation.en.php?email=\"+email+\"&lang=EN\";\r\n        \"https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=\"+email+\"&\"\r\n        + \"lc=\"+lang+\"&item_name=InfoDesk&no_note=0&currency_code=\"+cur+\"&\"\r\n        + \"bn=PP%2dDonationsBF%3abtn_donate_SM%2egif%3aNonHostedGuest\";\r\n\r\n    window.open(url, owner, \"width=500, height=500\");\r\n    //event.preventDefault();\r\n    scrollToBottom($('#bottom'), function () {\r\n\r\n    });\r\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./browser/browser.js\n// module id = 593\n// module chunks = 1"],"sourceRoot":""}